<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>الحضري للبرمجيات</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;800&display=swap" rel="stylesheet">
<style>
body{font-family:'Cairo',sans-serif;margin:0;padding:0;background:#f2f5f8;}
header{background:#0d47a1;color:#fff;padding:20px;text-align:center;font-size:28px;font-weight:bold}
nav{background:#1565c0;color:#fff;padding:10px;text-align:center}
nav a{color:#fff;margin:0 10px;text-decoration:none;font-weight:bold;cursor:pointer}
nav a:hover{text-decoration:underline}
.container{max-width:900px;margin:20px auto;padding:15px;background:#fff;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,0.15)}
input,textarea,select,button{width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #ccc;font-size:14px}
button{background:#0d47a1;color:#fff;border:none;cursor:pointer;font-weight:bold}
button:hover{background:#1565c0}
.page{display:none}
.hero{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;padding:20px}
.hero-left{flex:1;min-width:250px}
.hero-right img{max-width:100%;border-radius:10px}
.projects-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-top:15px}
.proj-card{background:#eef3ff;padding:10px;border-radius:8px;text-align:center}
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);display:flex;justify-content:center;align-items:center;z-index:10}
.sheet{background:#fff;padding:20px;border-radius:10px;width:90%;max-width:400px;position:relative}
.close-btn{position:absolute;top:10px;right:10px;background:none;border:none;font-size:20px;cursor:pointer}
.admin-box{margin-top:10px;padding:10px;background:#dce5ff;border-radius:10px}
footer{text-align:center;padding:15px;background:#0d47a1;color:#fff;margin-top:20px}
.small{font-size:12px;color:#555}
</style>
</head>
<body>

<header class="site-header">
  الحضري للبرمجيات
  <nav>
    <a onclick="showSection('home')">الرئيسية</a>
    <a onclick="showSection('projects')">مشاريعنا</a>
    <a onclick="showSection('dashboard')">لوحة التحكم</a>
  </nav>
</header>

<div class="container">

  <!-- Home -->
  <section id="home" class="page">
    <div class="hero">
      <div class="hero-left">
        <h1>نحو حلول رقمية احترافية</h1>
        <p>نصمّم ونطوّر مواقع وتطبيقات متكاملة تناسب احتياجات المؤسسات والشركات.</p>
        <button onclick="showSection('projects')">شاهد مشاريعنا</button>
      </div>
      <div class="hero-right">
        <img src="https://images.unsplash.com/photo-1555949963-aa79dcee981c?auto=format&fit=crop&w=800&q=80" alt="Dev">
      </div>
    </div>
  </section>

  <!-- Projects -->
  <section id="projects" class="page">
    <h2>أبرز مشاريعنا</h2>
    <div id="projectsGrid" class="projects-grid"></div>
  </section>

  <!-- Dashboard -->
  <section id="dashboard" class="page">
    <h2>لوحة التحكم</h2>
    <div id="adminBox" class="admin-box">
      <h3>أضف مشروع جديد</h3>
      <input id="projTitle" placeholder="عنوان المشروع">
      <textarea id="projDesc" placeholder="وصف المشروع"></textarea>
      <input type="file" id="projImage" accept="image/*">
      <button id="addProjectBtn">نشر المشروع</button>
      <p id="adminStatus" class="small"></p>
    </div>
  </section>

</div>

<footer>
  © 2025 الحضري للبرمجيات
</footer>

<!-- Firebase SDKs (compat) -->
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-storage-compat.js"></script>

<!-- App JS -->
<script>
/* ===== Firebase config ===== */
const firebaseConfig = {
  apiKey: "AIzaSyDxoEJLaGcEy7s1P2nE2_bDniS71ldI31Q",
  authDomain: "alhadari-net.firebaseapp.com",
  databaseURL: "https://alhadari-net-default-rtdb.firebaseio.com",
  projectId: "alhadari-net",
  storageBucket: "alhadari-net.firebasestorage.app",
  messagingSenderId: "465757130283",
  appId: "1:465757130283:web:10128c19bef6171e5e246e",
  measurementId: "G-XLQB1M9FHQ"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();
const storage = firebase.storage();

/* ===== Admin UID ===== */
const ADMIN_UID = "ضع_UID_هنا";

/* ===== Functions ===== */
function showSection(id){
  document.querySelectorAll('.page').forEach(p=>p.style.display='none');
  const el = document.getElementById(id);
  if(el) el.style.display='block';
}

/* ===== Add project ===== */
document.getElementById('addProjectBtn').addEventListener('click', async ()=>{
  const title = document.getElementById('projTitle').value.trim();
  const desc = document.getElementById('projDesc').value.trim();
  const file = document.getElementById('projImage').files[0];
  const adminStatus = document.getElementById('adminStatus');
  adminStatus.textContent = '';
  if(!title || !desc){ adminStatus.textContent='املأ العنوان والوصف'; return; }
  if(!auth.currentUser || auth.currentUser.uid !== ADMIN_UID){ adminStatus.textContent='أنت لست مشرفاً'; return; }

  adminStatus.textContent = '⏳ جاري رفع المشروع...';
  try{
    const newRef = db.ref('projects').push();
    const id = newRef.key;
    let imageUrl = '';
    if(file){
      const storageRef = storage.ref().child('projects/'+id+'_'+file.name);
      await storageRef.put(file);
      imageUrl = await storageRef.getDownloadURL();
    }
    await newRef.set({ title, desc, image: imageUrl, createdAt: Date.now() });
    adminStatus.textContent = '✅ تم نشر المشروع';
    document.getElementById('projTitle').value='';
    document.getElementById('projDesc').value='';
    document.getElementById('projImage').value='';
  }catch(e){
    console.error(e);
    adminStatus.textContent = '❌ خطأ: '+e.message;
  }
});

/* ===== Listen Projects ===== */
const projectsGrid = document.getElementById('projectsGrid');
db.ref('projects').orderByChild('createdAt').on('value', snapshot=>{
  const data = snapshot.val() || {};
  projectsGrid.innerHTML='';
  Object.keys(data).sort((a,b)=>data[b].createdAt - data[a].createdAt).forEach(key=>{
    const p = data[key];
    const div = document.createElement('div');
    div.className='proj-card';
    div.innerHTML = `${p.image ? `<img src="${p.image}" alt="${p.title}">` : ''}<h4>${p.title}</h4><p>${p.desc}</p>`;
    projectsGrid.appendChild(div);
  });
});

/* ===== Init ===== */
showSection('home');
</script>

</body>
</html>
